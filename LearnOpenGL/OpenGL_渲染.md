
#### 颜色
- 物体所显现出的颜色是不被他所吸收的光的颜色
- 如将白光照在一个蓝色的玩具上，这个蓝色的玩具会吸收白光中除了蓝色以外的所有子颜色，不被吸收的蓝色光被反射到我们的眼中，让这个玩具看起来是蓝色的

- **物体的颜色RGB(r,g,b)** 可以理解为物体对于红色、绿色、蓝色三个颜色分量的反射率/反射量。比如rgb(1.0f, 0.5f, 0.3f);是物体不吸收任何红色，100%全部反射，只吸收一半的绿色，只吸收另一半，而可以吸收70%的蓝色，只反射30%的蓝色


#### 基础光照
- ###### Phong Lighting Model
	- **漫反射/Diffuse**
		- 模拟光源对物体的方向性影响(Directional Impact)。它是冯氏光照模型中视觉上最显著的分量。物体的某一部分越是正对着光源，它就会越亮
		- ***计算漫反射需要：***
			- 法线方向：垂直于顶点表面的向量
			- 定向的光线方向：光的位置向量和片段的位置向量
	- **镜面反射/Specular**
		- 模拟有光泽物体上面出现的亮点。镜面光照的颜色相比于物体的颜色会更倾向于光的颜色
		- ***计算镜面反射需要：***
			- 法线方向
			- 光方向
			- 视方向
	- **环境光/Ambient**
		- 模拟光线在物体表面反射，并对周围的其他物体产生影响的全局光照效果
*早期为了节省性能而在顶点着色器中计算Phong模型。在顶点着色器中实现的Phong光照模型叫Gouraud着色(Gouraud Shading)，而不是Phong着色(Phong Shading)*

#### 法线方向
- 垂直于顶点表面的**单位**向量


#### 投光物
- ###### 平行光
	- 假定光源位置无限远
	- 所有光线都有着相同的方向，与光源的位置无关
	- ![[OpenGL_平行光.png]]
- ###### 点光源
	- 会朝着所有方向发光，但光线会随着距离而逐渐衰减
	- ![[OpenGL_点光源.png]]
	- **衰减(Attenuation)**：随着光线传播距离的增长而逐渐削减光的强度
		- ![[OpenGL_光源衰减公式.png]]
			- **d**：片段距离光源的距离
			- **常数项K<sub>c</sub>**：通常保持为1.0。主要的作用是保证分母永远不会比1小，否则在某些距离上这个公式反而会增加光的强度而不是减弱
			- **一次项K<sub>l</sub>**：会与距离相乘，以线性的方式减少光强
			- **二次项K<sub>q</sub>**：会与距离的平方相乘，让光源以二次递减的方式减少强度
			- *二次项在距离近的时候（d很小），对光强的影响比一次项小很多；而当距离远的时候（d很大），二次项对光强的影响变大，使得光强以更快的速度下降*
			- *可以将环境光分量保持不变，让环境光照不会随着距离减少，但是如果我们使用多于一个的光源，所有的环境光分量将会开始叠加，所以在这种情况下我们也希望衰减环境光照*
			- ![[OpenGL_光的衰减图.png]]
			- *计算完光强衰减后分别乘给环境光、漫反射和镜面反射*
			- [点光源公式衰减系数表](https://wiki.ogre3d.org/tiki-index.php?page=-Point+Light+Attenuation)
- ###### 聚光灯
	- 只朝一个方向照射光线，而不是向所有方向。只有在聚光灯方向的特定半径内的物体才会被照亮
	- **聚光灯的组成**
		- 聚光灯的世界空间位置
		- 聚光灯的照射方向
		- 切光角（cutoff angle）：聚光灯光锥的半径
	- ![[OpenGL_聚光灯.png]]
		- LightDir：从片段指向光源的向量
		- SpotDir：聚光灯所指的方向
		- Phi (ϕ) ：指定了聚光灯的半径的切光角，角度外的物体不会被聚光灯照亮
		- Theta (θ) ：LightDir和SpotDir之间的夹角。在聚光灯照射范围内部的话θ值应该比ϕ小
		- *通过对比θ和ϕ来确认片段是否在聚光灯的照射范围内部*
	- **平滑/软化边缘**
		- 需要一个内圆锥(Inner Cone)和一个外圆锥(Outer Cone)。光从内圆锥逐渐减暗，直到外圆锥的边界
		- 创建外圆锥只需要再定义一个余弦值来代表聚光灯方向和外圆锥向量的夹角，也就是聚光灯方向和外圆锥向量的点乘值
		- 在内圆锥范围之内的片段光强为1.0，在外圆锥范围外的片段光强为0.0，在内外圆锥之间的片段会计算出0.0到1.0之间的光强。计算公式：
		- ![[OpenGL_聚光灯软化边缘公式.png]]
			- ϕ：内圆锥余弦值
			- γ：外圆锥余弦值
			- ϵ：内外圆锥的余弦值差(ϵ=ϕ−γ)
			- I：当前片段的聚光灯光强
			- *得到聚光灯光强后记得clamp到 0-1 ，不然聚光灯范围外的片段的光照强度会是负数，会变得死黑*
